{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImageData(searchRequest, page, limit = 15) {\n  const urlOptions = {\n    http: 'https://pixabay.com/api/',\n    key: '43793393-3131be18ae161d81d2e9721c8',\n    options: 'image_type=photo&orientation=horizontal&safesearch=true',\n  };\n\n  const params = {\n    key: urlOptions.key,\n    q: searchRequest,\n    per_page: limit,\n    page: page,\n    ...Object.fromEntries(new URLSearchParams(urlOptions.options)),\n  };\n\n  const { data } = await axios.get(urlOptions.http, { params });\n  if (data.totalHits) {\n    const totalPages = Math.ceil(data.totalHits / limit);\n    const pagesArray = [];\n    for (let i = 1; i <= totalPages; i++) {\n      pagesArray.push(i);\n    }\n\n    window.totalPages = totalPages;\n  }\n  return data.hits;\n}\n","export const refs = {\n  searchForm: document.querySelector('.search-bar-form'),\n  searchInput: document.querySelector('#search-bar'),\n  searchButton: document.querySelector('button'),\n  galleryList: document.querySelector('.gallery-list'),\n  extensionButton: document.querySelector('.extentionButton'),\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './refs';\nimport { currentPage } from '../main';\n\nfunction initializeLightbox() {\n  return new SimpleLightbox('.image-card-link', {\n    caption: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionDelay: 250,\n    captionPosition: 'bottom',\n  });\n}\n\nfunction initializeIziToast() {\n  iziToast.settings({\n    timeout: 5000,\n    titleColor: '#fff',\n    position: 'topRight',\n    messageColor: '#fff',\n    icon: '',\n    close: false,\n  });\n}\n\nlet notificationShown = false;\n\nexport function showNotification(\n  message = 'Sorry, there are no images matching your search query. Please try again!'\n) {\n  if (!notificationShown) {\n    initializeIziToast();\n\n    iziToast.error({\n      message,\n      class: 'error-notification',\n      timeout: 5000,\n      iconUrl: '/img/octagon.svg',\n      titleColor: '#fff',\n      position: 'topRight',\n      backgroundColor: 'red',\n      messageColor: '#fff',\n      progressBarColor: '#B51B1B',\n      close: true,\n    });\n\n    notificationShown = true;\n  }\n}\n\nexport function updateUi(arrayImages) {\n  const gallery = document.querySelector('.gallery-list');\n\n  const markup = arrayImages\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class=\"image-card\">\n      <a href=\"${largeImageURL}\" class=\"image-card-link\">\n        <img src=\"${webformatURL}\" width=\"360\" height=\"200\" class=\"image-card-thumb\" alt=\"${tags}\">\n        <ul class=\"image-card-details-list\">\n          <li class=\"image-card-details-list-item\">\n            <p class=\"image-card-details-title\">Likes</p>\n            <p class=\"image-card-details-text\">${likes}</p>\n          </li>\n          <li class=\"image-card-details-list-item\">\n            <p class=\"image-card-details-title\">Views</p>\n            <p class=\"image-card-details-text\">${views}</p>\n          </li>\n          <li class=\"image-card-details-list-item\">\n            <p class=\"image-card-details-title\">Comments</p>\n            <p class=\"image-card-details-text\">${comments}</p>\n          </li>\n          <li class=\"image-card-details-list-item\">\n            <p class=\"image-card-details-title\">Downloads</p>\n            <p class=\"image-card-details-text\">${downloads}</p>\n          </li>\n        </ul>\n      </a>\n    </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  initializeLightbox().refresh();\n}\n\nexport function updateButtonUi() {\n  if (currentPage >= window.totalPages) {\n    refs.extensionButton.style.display = 'none';\n\n    iziToast.error({\n      message: \"We're sorry, there are no more posts to load\",\n      class: 'error-notification',\n      timeout: 5000,\n      iconUrl: '/img/octagon.svg',\n      titleColor: '#fff',\n      position: 'topRight',\n      backgroundColor: 'red',\n      messageColor: '#fff',\n      progressBarColor: '#B51B1B',\n      close: true,\n    });\n  }\n}\n\nexport function getUserValue(event) {\n  const button = document.querySelector('button');\n  const value = event.target.value.trim();\n\n  if (value) {\n    button.classList.remove('is-disable');\n    button.removeAttribute('disabled');\n  } else {\n    button.classList.add('is-disable');\n    button.setAttribute('disabled', '');\n  }\n\n  return value;\n}\n\nexport function showLoader(status) {\n  const loader = document.querySelector('.loader');\n  loader.classList.toggle('is-active', status);\n}\n","import './js/pixabay-api';\nimport { fetchImageData } from './js/pixabay-api';\nimport './js/render-functions';\nimport { refs } from './js/refs';\nimport {\n  showNotification,\n  updateUi,\n  updateButtonUi,\n  showLoader,\n} from './js/render-functions';\n\nlet limit = 15;\nexport let userSearchRequestValue = '';\nexport let currentPage = 1;\n\nfunction clearGallery() {\n  refs.galleryList.innerHTML = '';\n}\n\nif (!refs.searchForm.dataset.listenerAttached) {\n  refs.searchForm.dataset.listenerAttached = 'true';\n\n  refs.searchForm.addEventListener('submit', async event => {\n    event.preventDefault();\n    clearGallery();\n    userSearchRequestValue = refs.searchInput.value.trim();\n    currentPage = 1;\n    if (userSearchRequestValue === '') {\n      refs.extensionButton.style.display = 'none';\n      showNotification('Please enter a search term.');\n      return;\n    }\n\n    refs.extensionButton.style.display = 'none';\n\n    showLoader(true);\n    setTimeout(async () => {\n      try {\n        const images = await fetchImageData(\n          userSearchRequestValue,\n          currentPage,\n          limit\n        );\n        updateUi(images);\n        if (refs.galleryList.childElementCount <= 0) {\n          showNotification('No images found.');\n        }\n\n        if (images.length > 0) {\n          refs.extensionButton.style.display = 'block';\n          refs.extensionButton.classList.remove('extentionButton');\n          refs.extensionButton.classList.add('div-button');\n        } else {\n          refs.extensionButton.style.display = 'none';\n        }\n      } catch (error) {\n        console.error('Error fetching or updating images:', error);\n        showNotification('An error occurred while fetching images.');\n      } finally {\n        showLoader(false);\n      }\n    }, 1000);\n\n    refs.searchInput.value = '';\n  });\n}\n\nif (!refs.extensionButton.dataset.listenerAttached) {\n  refs.extensionButton.dataset.listenerAttached = 'true';\n\n  refs.extensionButton.addEventListener('click', async event => {\n    event.preventDefault();\n    showLoader(true);\n\n    currentPage += 1;\n\n    setTimeout(async () => {\n      try {\n        const images = await fetchImageData(\n          userSearchRequestValue,\n          currentPage,\n          limit\n        );\n        updateUi(images);\n        updateButtonUi();\n\n        scrollGallery();\n      } catch (error) {\n        console.error('Error fetching or updating images:', error);\n      } finally {\n        showLoader(false);\n      }\n    }, 1000);\n  });\n}\n\nfunction scrollGallery() {\n  const rect = refs.galleryList.getBoundingClientRect();\n  const scrollDistance = rect.height * 2;\n  const scrollSpeed = 500;\n  const scrollStep = scrollDistance / (1000 / scrollSpeed);\n\n  let scrolled = 0;\n\n  const scrollInterval = setInterval(() => {\n    window.scrollBy({\n      top: scrollStep,\n      left: 0,\n      behavior: 'smooth',\n    });\n    scrolled += scrollStep;\n\n    if (scrolled >= scrollDistance) {\n      clearInterval(scrollInterval);\n    }\n  }, scrollSpeed);\n}\n"],"names":["fetchImageData","searchRequest","page","limit","urlOptions","params","data","axios","totalPages","refs","initializeLightbox","SimpleLightbox","initializeIziToast","iziToast","notificationShown","showNotification","message","updateUi","arrayImages","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateButtonUi","currentPage","showLoader","status","userSearchRequestValue","clearGallery","event","images","error","scrollGallery","scrollDistance","scrollSpeed","scrollStep","scrolled","scrollInterval"],"mappings":"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"}